## 簡化版本
刪除所有防呆的判斷，盡量讓代碼減少，並合併成一個檔案